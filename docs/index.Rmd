---
title: "lglasso: identify networks from correlated data"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduction_of_lglasso_package}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

The initial version of the package implemented the algorithms proposed in Zhou et al. (2021), which can estimate the high-dimensional  networks  from longitudinal data using Gassian grapical models. The current version includes several important extensions and improvements compared to the previous ones. The overarching goal however is the same, i.e., utilize the possible correlations between high-dimensional data to improve the estimations of networks.  Specifically, currently the package implements three network models which correspond to three different way how the correlated data are modeled. Furthermore, the package can also estimate the individual networks for each cohorts which is particular useful in clinical studies. 




```{r setup, message=FALSE,warning=FALSE}
library(lglasso)
```

There are two main functions in this package. The first one is $lglasso$ which output sparse networks representing the general precision matrix or individual networks, depending on how the input arguments are set up.   The second function, $cv.lglasso$, try to search for the optimal tuning parameters for $lglasso$ using cross validation method.   

```{r, message=FALSE}
# number of nodes
p=50
# number of edge in general network
m1=200
# the difference between the number of edges in individual networks and general network
m2=50
#  number of clusters
m3=5
# number of subjects
n=20
# correlation between cluster
rho=0.8

```

## Model 1: clustered data with no correlation structure
```{r, message=FALSE}
set.seed(5)
cc=matrix(rho,ncol = m3,nrow = m3)
diag(cc)=1
dd=simulate(n=n,p=p,m1=m1,m2=m2,m3=m3,cc=cc,homo=T)
ddata=dd$data
```

### estimate individual networks
```{r}
aa=lglasso(data=ddata,lambda = c(0.1,0.1),type="general",group = ddata[,2])
aa
cov2cor(aa$v)
```

### estiamte general networks

```{r}
aa=lglasso(data=ddata,lambda = 0.1,type="general")
aa
cov2cor(aa$v)
```

## Model 2: longitudinal data with one-parameter structured correlation 


```{r}

set.seed(5)
dd=simulate_long(n=n,p=p,m1=m1,tau=c(2,1))
ddata=dd$data
group=rep(c(1,2),71)
```


### estimate individual networks

```{r}
aa=lglasso(data=ddata,lambda = c(0.1,0.1),type="expFixed",expFix=1,group = group)
aa
```


### estiamte general networks

```{r}
aa=lglasso(data=ddata,lambda = 0.1,,type="expFixed",expFix=1)
aa
```


## Model 3: longitudinal data with two-parameter structured correlation 

```{r}

set.seed(5)
dd=simulate_long(n=n,p=p,m1=m1,tau=c(2,1))
ddata=dd$data
group=rep(c(1,2),71)
```


### estimate individual networks

```{r}
aa=lglasso(data=ddata,lambda = c(0.001,0.1),type="twoPara",group=group)
aa
```


### estiamte general networks

```{r}
aa=lglasso(data=ddata,lambda = 0.001,type="twoPara")
aa
```




[1] Zhou, J., Gui, J., Viles, W.D., Chen, H., Madan, J.C., Coker, M.O., Hoen, A.G., 2021a. Identifying Microbial Interaction Networks Based on Irregularly Spaced Longitudinal 16S rRNA sequence data. https://doi.org/10.1101/2021.11.26.470159



[2] Friedman J., Hastie T., Tibshirani R. (2019)  Graphical Lasso: Estimation of Gaussian Graphical Models, Version: 1.11. https://CRAN.R-project.org/package=glasso. 

