---
title: " Identify networks from correlated data (1)"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduction_of_lglasso_package}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```







```{r setup, message=FALSE,warning=FALSE}
library(lglasso)
```



```{r, message=FALSE}
# number of nodes
p=10
# number of edge in general network
m1=10
# the difference between the number of edges in individual networks and general network
m2=0
#  number of clusters
m3=4
# number of subjects
n=20
# correlation between cluster
rho=0.8

```

## Model 1: clustered data with no correlation structure
```{r, message=FALSE}
set.seed(5)
cc=matrix(rho,ncol = m3,nrow = m3)
diag(cc)=1
dd=Simulate(type="general",n=n,p=p,m1=m1,m2=m2,m3=m3,cc=cc)
ddata=dd$data
```



### estiamte general networks

```{r}
aa=lglasso(data=ddata,lambda = 0.1,type="general",tol = 0.01, trace=TRUE)

## precision matrix
aa$wi

## correlation between different tissues
cov2cor(aa$v)
```

### estimate individual networks
```{r}
aa=lglasso(data=ddata,lambda = c(1,1),type="general",group = ddata[,2], ,tol = 0.01, trace=TRUE)
aa$wiList
```

## Model 2: longitudinal data with one-parameter structured correlation 


```{r}

set.seed(5)
dd=Simulate(type="longihomo",n=n,p=p,m1=m1,tau=c(2,1))
ddata=dd$data
group=rep(c(1,2),71)
```





### estiamte general networks

```{r}
aa=lglasso(data=ddata,lambda = 1,type="expFixed",expFix=1,,tol = 0.01, trace=TRUE)
aa$wi
```


### estimate individual networks

```{r}
aa=lglasso(data=ddata,lambda = c(1,1),type="expFixed",expFix=1,group = group, ,tol = 0.01, trace=TRUE)
aa$wiList
```


## Model 3: longitudinal data with two-parameter structured correlation 

```{r}

set.seed(5)
dd=Simulate(type="longiheter",n=n,p=p,m1=m1,alpha=2)
ddata=dd$data
group=rep(c(1,2),78)
```





### estimate general networks

```{r}
aa=lglasso(data=ddata,lambda = 1,type="twoPara", ,tol = 0.01, trace=TRUE)
aa$wi
```

### estimate individual networks

```{r}
aa=lglasso(data=ddata,lambda = c(1,1),type="twoPara",group=group, ,tol = 0.01, trace=TRUE)
aa$wiList
```


[1] Zhou J, Gui J, Viles WD, Chen H, Li S, Madan JC, Coker MO, Hoen AG. Identifying stationary microbial interaction networks based on irregularly spaced longitudinal 16S rRNA gene sequencing data. Front Microbiomes. 2024;3:1366948. doi: 10.3389/frmbi.2024.1366948. Epub 2024 Jun 2. PMID: 40687607; PMCID: PMC12276884.


[2] Friedman J., Hastie T., Tibshirani R. (2019)  Graphical Lasso: Estimation of Gaussian Graphical Models, Version: 1.11. https://CRAN.R-project.org/package=glasso. 

